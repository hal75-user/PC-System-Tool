# エラー判定ロジック説明ドキュメント

## 📋 概要

このドキュメントは、ゼッケン通過順エラーが多い問題について、**コードを変更せずに**現在のエラー判定ロジックを説明したものです。

## 📚 作成されたドキュメント

### 1. 【要約版】エラー判定ロジック_要約.md
**おすすめ: まずこちらをお読みください**

- ゼッケン通過順エラーが多い理由の説明
- 全7種類のエラーの一覧と概要
- 対処方法のベストプラクティス
- 読みやすさ重視の簡潔な説明

👉 **[エラー判定ロジック_要約.md](./エラー判定ロジック_要約.md)**

### 2. 【詳細版】全エラー判定条件_詳細説明.md
**詳細な判定ロジックが知りたい方向け**

- 全7種類のエラーの詳細な判定条件
- 実際のコードロジックの説明
- エラーメッセージの例
- 同一エラー判定のロジック
- 完全な技術情報

👉 **[全エラー判定条件_詳細説明.md](./全エラー判定条件_詳細説明.md)**

## ❓ よくある質問への回答

### Q1: ゼッケン通過順エラーが多すぎるのはなぜ？

**理由:**
1. 全ゼッケンを個別に判定（100台なら最大100個のエラー）
2. 2つ以上の区間を通過したすべてのゼッケンが対象
3. 期待される順序と実際の通過順序を厳格に比較
4. 1つでも順序が違えばエラー

**対処方法:**
- エラー確認ウィンドウで「確認済み」にする
- データが正しい場合は「すべて確認済みにする」を使用
- 確認済みにすると未確認エラーのカウントから除外

詳細は[エラー判定ロジック_要約.md](./エラー判定ロジック_要約.md)の「Q1: ゼッケン通過順エラーが多すぎる理由は？」を参照

### Q2: 各エラーの判定条件は？

全7種類のエラー:

1. **CSVファイル名重複** - 同じ区間名が複数ファイルに存在 ❌確認不可
2. **ゼッケン重複** - 同じ区間で同じゼッケンが2回以上出現 ❌確認不可
3. **区間通過順** - グループ内の区間で通過順序が不一致 ✅確認可
4. **ゼッケン通過順** - ゼッケンが区間を正しい順序で通過していない ✅確認可
5. **ステータス不正** - RIT/BLNKなのに走行データがある ✅確認可
6. **計測タイプ確認** - 手動計測（type=T）にゼッケンが入力 ✅確認可
7. **計測データ不備** - 半数以上が異常（1秒以上ずれ/得点0） ✅確認可

詳細は[全エラー判定条件_詳細説明.md](./全エラー判定条件_詳細説明.md)を参照

### Q3: エラーの対処優先順位は？

```
【最優先】必ず修正（確認不可）
  1. CSVファイル名重複
  2. ゼッケン重複

【高】確認が必要
  3. ステータス不正

【中】警告的なもの
  4. 計測タイプ確認
  5. 計測データ不備

【低】確認後に判断
  6. 区間通過順
  7. ゼッケン通過順
```

## 🔍 その他の関連ドキュメント

以下の既存ドキュメントも参考になります：

- **ERROR_HANDLING_GUIDE.md** - エラーハンドリング機能の使い方ガイド
- **DATA_VALIDATION_GUIDE.md** - データ検証機能の詳細ガイド
- **ERROR_HANDLING_IMPLEMENTATION.md** - 技術的な実装詳細（英語）
- **data_validator.py** - 実装コード

## 💡 ベストプラクティス

### エラー発生時の効率的な作業フロー

```
1. Race読み込み
   ↓
2. 赤ボタン「⚠️ エラーあり」をクリック
   ↓
3. エラー確認ウィンドウで確認
   ↓
4. 重大エラー（CSVファイル名重複、ゼッケン重複）を修正
   ↓
5. ゼッケン通過順エラーが多い場合
   → データが正しいなら「すべて確認済みにする」
   ↓
6. 個別に確認が必要なエラーを確認
   ↓
7. 計算実行
   ↓
8. 計測データ不備エラーを確認（計算実行後）
   ↓
9. 必要に応じて修正して再計算
```

## 📝 まとめ

**作成日**: 2026年2月18日

**変更内容**:
- ✅ コードは一切変更していません
- ✅ 現在のエラー判定ロジックを詳細に説明
- ✅ ゼッケン通過順エラーが多い理由を解明
- ✅ 全7種類のエラーの判定条件を整理
- ✅ 対処方法のベストプラクティスを提供

**ドキュメント一覧**:
1. エラー判定ロジック_要約.md（要約版）
2. 全エラー判定条件_詳細説明.md（詳細版）
3. エラー判定ロジック説明_README.md（このファイル）

ご不明な点がございましたら、お気軽にお問い合わせください。
