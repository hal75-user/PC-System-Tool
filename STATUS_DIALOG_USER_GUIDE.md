# ステータス設定画面 新機能ガイド

## 🎉 追加された新機能

### 1. ゼッケン番号フィルター 🔍

特定のゼッケンだけを表示できるフィルター機能を追加しました。

#### 使い方

**基本操作:**

1. **条件を追加する**
   - 「+ 条件追加」ボタンをクリック
   - ゼッケン番号を入力（例: 5）
   - さらに条件を追加する場合は、再度「+ 条件追加」をクリック

2. **条件を削除する**
   - 各条件の横にある「×」ボタンをクリック
   - その条件が削除されます

3. **フィルターを適用する**
   - 「フィルター適用」ボタンをクリック
   - 入力したゼッケン番号のみが表示されます

4. **全表示に戻す**
   - 「全表示」ボタンをクリック
   - すべてのゼッケンが表示されます
   - **重要**: フィルター条件は消えません！
   - 再度「フィルター適用」を押せば、同じ条件で絞り込めます

#### 具体例

**シナリオ1: ゼッケン5と10だけを表示したい**

```
手順:
1. 「+ 条件追加」をクリック
2. 「5」と入力
3. 「+ 条件追加」をクリック  
4. 「10」と入力
5. 「フィルター適用」をクリック

結果:
→ ゼッケン5と10の行だけが表示される
→ 他のゼッケンは非表示になる
```

**シナリオ2: 一時的に全体を見たい**

```
手順:
1. （フィルター適用中の状態から）
2. 「全表示」をクリック

結果:
→ すべてのゼッケンが表示される
→ フィルター条件（5, 10）は残っている

3. 「フィルター適用」をクリック

結果:
→ 再度ゼッケン5と10だけが表示される
```

**シナリオ3: 条件を変更したい**

```
手順:
1. 不要な条件の「×」ボタンをクリック
2. 新しい条件を「+ 条件追加」で追加
3. 「フィルター適用」をクリック

結果:
→ 新しい条件で絞り込まれる
```

### 2. 日別タブ表示 📅

結果表示画面と同じように、日別/グループ別のタブ表示に対応しました。

#### 使い方

**タブの種類:**

1. **全日タブ**
   - すべての区間を表示
   - デフォルトで開いている

2. **日別タブ（1日目、2日目、...）**
   - 各日の区間のみを表示
   - section_*.csv の DAY 列に基づいて自動生成

3. **グループタブ（グループ1、グループ2、...）**
   - DAY列がない場合に表示
   - GROUP 列に基づいて自動生成

#### 具体例

**シナリオ1: 1日目の区間だけを設定したい**

```
手順:
1. 「1日目」タブをクリック

結果:
→ 1日目の区間だけが表示される
→ ステータス設定が簡単に

利点:
- 区間が多くても見やすい
- 日別に作業を分けられる
```

**シナリオ2: フィルターとタブを組み合わせる**

```
手順:
1. ゼッケン5, 10のフィルターを設定
2. 「フィルター適用」をクリック
3. 「1日目」タブをクリック

結果:
→ 1日目の区間で、ゼッケン5と10だけが表示される
→ 非常に絞り込まれた表示で作業しやすい

4. 「2日目」タブをクリック

結果:
→ 2日目の区間で、同じフィルターが適用される
→ タブを切り替えてもフィルターは維持される
```

## 💡 便利な使い方

### ケース1: 特定のチームだけを設定したい

複数のチームが参加している場合：

```
例: Aチーム（ゼッケン1-10）とBチーム（ゼッケン21-30）

手順:
1. ゼッケン1, 2, 3, ..., 10 を条件追加
2. ゼッケン21, 22, 23, ..., 30 を条件追加
3. 「フィルター適用」をクリック
4. Aチーム、Bチームのみが表示される
5. まとめて RIT や N.C. を設定できる
```

### ケース2: 日ごとに異なるステータスを設定

```
例: 1日目は完走、2日目はリタイヤ

手順:
1. 「2日目」タブをクリック
2. リタイヤしたゼッケンをフィルターで絞り込む
3. 2日目の区間にまとめて RIT を設定
4. 「全日」タブに戻って確認
```

### ケース3: 作業を一時中断して再開

```
手順:
1. フィルター条件を設定（例: 5, 10, 15）
2. 一部のステータスを設定
3. 「保存」をクリック
4. アプリを終了

翌日:
1. アプリを起動
2. ステータス設定画面を開く
3. フィルター条件が保持されている
4. 「フィルター適用」をクリック
5. 続きから作業できる
```

## 🎨 画面レイアウト

```
┌─────────────────────────────────────────────────────┐
│ 区間ステータス設定                                     │
├─────────────────────────────────────────────────────┤
│                                                     │
│ セルをクリックまたはドラッグして選択し、             │
│ 選択中のステータスを適用します                        │
│                                                     │
│ ステータス選択:                                      │
│ [ 空白 ] [ RIT ] [ N.C. ] [ BLNK ]                  │
│                                                     │
│ ─────────────────────────────────────────────────   │
│ ゼッケン番号フィルター:                              │
│                                                     │
│ ┌────────────────────────┬──────────────────┐      │
│ │ [  5  ] [×]            │ [+ 条件追加]      │      │
│ │ [ 10  ] [×]            │                  │      │
│ │ [ 15  ] [×]            │ [フィルター適用]  │      │
│ │                        │                  │      │
│ │ （スクロール可能）      │ [全表示]         │      │
│ └────────────────────────┴──────────────────┘      │
│                                                     │
│ ─────────────────────────────────────────────────   │
│                                                     │
│ ┌─ タブ ───────────────────────────────────┐       │
│ │ [ 全日 ] [ 1日目 ] [ 2日目 ] [ 3日目 ]   │       │
│ ├─────────────────────────────────────────┤       │
│ │                                         │       │
│ │  ゼッケン │ PC1 │ PC2 │ PC3 │ PC4 │... │       │
│ │  ────────┼─────┼─────┼─────┼─────┼─── │       │
│ │     5    │     │     │ RIT │     │    │       │
│ │    10    │ N.C.│     │     │BLNK │    │       │
│ │    15    │     │     │     │     │    │       │
│ │                                         │       │
│ │ （フィルター適用中はゼッケン5,10,15のみ）│       │
│ │ （全表示中はすべてのゼッケンを表示）    │       │
│ │                                         │       │
│ └─────────────────────────────────────────┘       │
│                                                     │
│ [ 保存 ] [ キャンセル ] [ すべてクリア ]             │
│                                                     │
└─────────────────────────────────────────────────────┘
```

## 🔄 従来との違い

### 従来のステータス設定画面

```
問題点:
❌ ゼッケンが多いとスクロールが大変
❌ 特定のゼッケンを探すのに時間がかかる
❌ すべての区間が一度に表示される
❌ 日別に分けて作業できない
```

### 新しいステータス設定画面

```
改善点:
✅ フィルターで必要なゼッケンだけを表示
✅ 条件を保存できるので繰り返し使える
✅ 日別/グループ別に整理された表示
✅ 結果画面と同じタブ構成で直感的
✅ 大量のゼッケンでも快適に作業できる
```

## ⚡ よくある質問

### Q1: フィルター条件は保存されますか？

**A: 保存されます。**

フィルター条件は以下の場合に保持されます:
- 「全表示」ボタンを押した後
- タブを切り替えた後
- 画面を閉じて開き直した場合は**リセット**されます

### Q2: 複数のゼッケンをまとめて設定できますか？

**A: できます。**

方法1: フィルターで絞り込んでから設定
```
1. 対象ゼッケンをフィルターで絞り込む
2. ステータスを選択（例: RIT）
3. セルをドラッグして選択
4. まとめて RIT が設定される
```

方法2: タブと組み合わせて設定
```
1. 日別タブで区間を限定
2. フィルターでゼッケンを限定
3. まとめて設定
```

### Q3: タブは自動で作成されますか？

**A: はい、自動で作成されます。**

- section_*.csv に DAY 列がある場合 → 日別タブ
- DAY 列がない場合 → GROUP 列でグループタブ
- どちらもない場合 → 全日タブのみ

### Q4: フィルターは各タブで別々に設定できますか？

**A: いいえ、すべてのタブで共通です。**

フィルターを設定すると:
- 全日タブ
- 1日目タブ
- 2日目タブ
- すべてのタブで同じフィルターが適用されます

利点: タブを切り替えても、見ているゼッケンは変わらない

### Q5: 従来の機能は使えますか？

**A: はい、すべて使えます。**

以下の機能は変更ありません:
- ✅ ステータス選択（空白、RIT、N.C.、BLNK）
- ✅ セルのクリック/ドラッグ選択
- ✅ 保存機能
- ✅ すべてクリア機能
- ✅ 既存のステータス設定の読み込み

## 📝 まとめ

### 新機能のメリット

1. **作業効率の向上**
   - フィルターで必要なゼッケンだけを表示
   - 大量のゼッケンでも快適に作業

2. **ミスの削減**
   - 日別/グループ別で整理
   - 間違った区間に設定するリスクが減る

3. **柔軟な作業方法**
   - フィルター条件を保存して再利用
   - タブとフィルターを組み合わせて自由に絞り込み

4. **直感的な操作**
   - 結果表示と同じタブ構成
   - 馴染みのあるUIで迷わない

---

**実装日**: 2026年2月17日  
**バージョン**: v2.0  
**互換性**: 既存の設定ファイルとの完全互換
